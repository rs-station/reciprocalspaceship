

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Anomalous Difference Map &mdash; reciprocalspaceship 0.8.9 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/rs-favicon_32x32.png"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Time-Resolved Difference Map" href="4_timeresolvedPYP.html" />
    <link rel="prev" title="HEWL S-SAD Merging Statistics" href="2_mergingstats.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> reciprocalspaceship
          

          
            
            <img src="../_static/rs.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../userguide/index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../userguide/overview.html">Overview and Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="0_quickstart.html">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/mtzdtypes.html">MTZ Data Types</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="1_basics.html">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="2_mergingstats.html">HEWL S-SAD Merging Statistics</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Anomalous Difference Map</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Background">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Computing-Structure-Factor-Amplitudes">Computing Structure Factor Amplitudes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Obtaining-Phases-by-Isomorphous-Replacement">Obtaining Phases by Isomorphous Replacement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Viewing-the-Map">Viewing the Map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="4_timeresolvedPYP.html">Time-Resolved Difference Map</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/index.html">For Developers</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">reciprocalspaceship</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../userguide/index.html">User Guide</a> &raquo;</li>
        
          <li><a href="examples.html">Examples</a> &raquo;</li>
        
      <li>Anomalous Difference Map</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/3_anomalousdifference.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Anomalous-Difference-Map">
<h1>Anomalous Difference Map<a class="headerlink" href="#Anomalous-Difference-Map" title="Permalink to this headline">¶</a></h1>
<p>In <a class="reference internal" href="1_basics.html"><span class="doc">Basics</span></a>, we loaded a room-temperature dataset that was collected at ~6550 eV of tetragonal HEWL. We then computed the <span class="math notranslate nohighlight">\(CC_{1/2}\)</span> and <span class="math notranslate nohighlight">\(CC_{anom}\)</span> for this data in <a class="reference internal" href="2_mergingstats.html"><span class="doc">Merging Statistics</span></a> and observed that there was significant anomalous signal. Let’s now use that data to generate an anomalous difference map based on the anomalous scattering from the native sulfur atoms.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">reciprocalspaceship</span> <span class="k">as</span> <span class="nn">rs</span>
<span class="kn">from</span> <span class="nn">reciprocalspaceship</span> <span class="kn">import</span> <span class="n">algorithms</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">refltable</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">read_mtz</span><span class="p">(</span><span class="s2">&quot;data/HEWL_SSAD_24IDC.mtz&quot;</span><span class="p">)</span>
<span class="n">refltable</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>FreeR_flag</th>
      <th>IMEAN</th>
      <th>SIGIMEAN</th>
      <th>I(+)</th>
      <th>SIGI(+)</th>
      <th>I(-)</th>
      <th>SIGI(-)</th>
      <th>N(+)</th>
      <th>N(-)</th>
    </tr>
    <tr>
      <th>H</th>
      <th>K</th>
      <th>L</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th rowspan="5" valign="top">0</th>
      <th>4</th>
      <td>14</td>
      <td>671.0396</td>
      <td>22.205784</td>
      <td>671.0396</td>
      <td>22.205784</td>
      <td>671.0396</td>
      <td>22.205784</td>
      <td>16</td>
      <td>16</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4</td>
      <td>3273.7385</td>
      <td>107.59589</td>
      <td>3273.7385</td>
      <td>107.59589</td>
      <td>3273.7385</td>
      <td>107.59589</td>
      <td>16</td>
      <td>16</td>
    </tr>
    <tr>
      <th>12</th>
      <td>6</td>
      <td>1367.5679</td>
      <td>43.352566</td>
      <td>1367.5679</td>
      <td>43.352566</td>
      <td>1367.5679</td>
      <td>43.352566</td>
      <td>16</td>
      <td>16</td>
    </tr>
    <tr>
      <th>16</th>
      <td>19</td>
      <td>4158.55</td>
      <td>198.88382</td>
      <td>4158.55</td>
      <td>198.88382</td>
      <td>4158.55</td>
      <td>198.88382</td>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <th>20</th>
      <td>8</td>
      <td>2.4992087</td>
      <td>5.7103205</td>
      <td>2.4992087</td>
      <td>5.7103205</td>
      <td>2.4992087</td>
      <td>5.7103205</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of reflections: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">refltable</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of reflections: 12563
</pre></div></div>
</div>
<hr class="docutils" />
<div class="section" id="Background">
<h2>Background<a class="headerlink" href="#Background" title="Permalink to this headline">¶</a></h2>
<p>Since this dataset was collected at a single wavelength, we can compute an anomalous difference map from the anomalous structure factor amplitudes, <span class="math notranslate nohighlight">\(|F_{A}|\)</span>, and their phase shifts, <span class="math notranslate nohighlight">\(\alpha\)</span>, relative to the computed phases from an isomorphous structure of tetragonal HEWL. We will compute <span class="math notranslate nohighlight">\(|F_{A}|\)</span> based on the following:</p>
<p><span class="math">\begin{equation*}
|F_{A}| \propto \Delta_{\mathrm{ano}} = |F_{HKL}| - |F_{\overline{HKL}}|
\end{equation*}</span></p>
<p>We will then use the PDB: 1VAT and <code class="docutils literal notranslate"><span class="pre">phenix.fmodel</span></code> to compute isomorphous phases, <span class="math notranslate nohighlight">\(\phi_c\)</span>, which can be used to determine the phases for the anomalous contribution, <span class="math notranslate nohighlight">\(\phi_A\)</span>, using the phase shift, <span class="math notranslate nohighlight">\(\alpha\)</span>:</p>
<p><span class="math">\begin{equation*}
\phi_A = \phi_c - \alpha
\end{equation*}</span></p>
<p>Since this is a SAD experiment, we can assume <span class="math notranslate nohighlight">\(\alpha\)</span> is 90˚ when <span class="math notranslate nohighlight">\(\Delta_{\mathrm{ano}}\)</span> is negative and 270˚ when it is positive. This formalism is based on <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3246834/pdf/j-44-01285.pdf">Thorn and Sheldrick, J Appl. Cryst. (2011)</a>.</p>
</div>
<hr class="docutils" />
<div class="section" id="Computing-Structure-Factor-Amplitudes">
<h2>Computing Structure Factor Amplitudes<a class="headerlink" href="#Computing-Structure-Factor-Amplitudes" title="Permalink to this headline">¶</a></h2>
<p>The dataset being used is the direct output from running scaling and merging in <a class="reference external" href="http://www.ccp4.ac.uk/html/aimless.html">AIMLESS</a>. As a first processing step, we need to convert the observed merged intensities, <span class="math notranslate nohighlight">\(I(+)\)</span> and <span class="math notranslate nohighlight">\(I(-)\)</span>, into observed structure factor amplitudes, <span class="math notranslate nohighlight">\(F(+)\)</span> and <span class="math notranslate nohighlight">\(F(-)\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># In order to scale the merged intensities, we must first get them into a single DataSet column</span>
<span class="n">stacked</span> <span class="o">=</span> <span class="n">refltable</span><span class="o">.</span><span class="n">stack_anomalous</span><span class="p">()</span>
<span class="n">stacked</span> <span class="o">=</span> <span class="n">stacked</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">stacked</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">stacked</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stacked</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>FreeR_flag</th>
      <th>IMEAN</th>
      <th>SIGIMEAN</th>
      <th>I</th>
      <th>SIGI</th>
      <th>N</th>
    </tr>
    <tr>
      <th>H</th>
      <th>K</th>
      <th>L</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">-45</th>
      <th rowspan="2" valign="top">-10</th>
      <th>-1</th>
      <td>19</td>
      <td>6.4083962</td>
      <td>1.9782588</td>
      <td>5.543211</td>
      <td>2.965243</td>
      <td>4</td>
    </tr>
    <tr>
      <th>0</th>
      <td>16</td>
      <td>7.999073</td>
      <td>2.9954805</td>
      <td>7.999073</td>
      <td>2.9954805</td>
      <td>4</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">-9</th>
      <th>-2</th>
      <td>11</td>
      <td>26.471386</td>
      <td>3.8778236</td>
      <td>26.471386</td>
      <td>3.8778236</td>
      <td>4</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>6</td>
      <td>4.3246555</td>
      <td>1.9706693</td>
      <td>2.7027502</td>
      <td>2.668546</td>
      <td>4</td>
    </tr>
    <tr>
      <th>0</th>
      <td>17</td>
      <td>60.28856</td>
      <td>5.675214</td>
      <td>60.28856</td>
      <td>5.675214</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In order to get structure factor amplitudes, we must first account for mean intensities that are negative due to background subtraction. We will use a method based on the Bayesian approach first proposed by <a class="reference external" href="https://scripts.iucr.org/cgi-bin/paper?a15572">French and Wilson</a> to ensure that all intensities are strictly positive. This method is implemented in <code class="docutils literal notranslate"><span class="pre">reciprocalspaceship.algorithms.scale_merged_intensities()</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scaled</span> <span class="o">=</span> <span class="n">algorithms</span><span class="o">.</span><span class="n">scale_merged_intensities</span><span class="p">(</span><span class="n">stacked</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;SIGI&quot;</span><span class="p">,</span> <span class="n">mean_intensity_method</span><span class="o">=</span><span class="s2">&quot;anisotropic&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scaled</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>FreeR_flag</th>
      <th>IMEAN</th>
      <th>SIGIMEAN</th>
      <th>I</th>
      <th>SIGI</th>
      <th>N</th>
      <th>dHKL</th>
      <th>CENTRIC</th>
      <th>FW-I</th>
      <th>FW-SIGI</th>
      <th>FW-F</th>
      <th>FW-SIGF</th>
    </tr>
    <tr>
      <th>H</th>
      <th>K</th>
      <th>L</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">-45</th>
      <th rowspan="2" valign="top">-10</th>
      <th>-1</th>
      <td>19</td>
      <td>6.4083962</td>
      <td>1.9782588</td>
      <td>5.543211</td>
      <td>2.965243</td>
      <td>4</td>
      <td>1.7194214</td>
      <td>False</td>
      <td>5.588304</td>
      <td>2.7283347</td>
      <td>2.3639593</td>
      <td>0.57706887</td>
    </tr>
    <tr>
      <th>0</th>
      <td>16</td>
      <td>7.999073</td>
      <td>2.9954805</td>
      <td>7.999073</td>
      <td>2.9954805</td>
      <td>4</td>
      <td>1.7212021</td>
      <td>True</td>
      <td>7.1421466</td>
      <td>3.141908</td>
      <td>2.6724794</td>
      <td>0.58782643</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">-9</th>
      <th>-2</th>
      <td>11</td>
      <td>26.471386</td>
      <td>3.8778236</td>
      <td>26.471386</td>
      <td>3.8778236</td>
      <td>4</td>
      <td>1.7217635</td>
      <td>False</td>
      <td>26.15096</td>
      <td>3.8778236</td>
      <td>5.113801</td>
      <td>0.37915277</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>6</td>
      <td>4.3246555</td>
      <td>1.9706693</td>
      <td>2.7027502</td>
      <td>2.668546</td>
      <td>4</td>
      <td>1.727144</td>
      <td>False</td>
      <td>3.3600478</td>
      <td>2.0947244</td>
      <td>1.8330433</td>
      <td>0.5713789</td>
    </tr>
    <tr>
      <th>0</th>
      <td>17</td>
      <td>60.28856</td>
      <td>5.675214</td>
      <td>60.28856</td>
      <td>5.675214</td>
      <td>4</td>
      <td>1.728949</td>
      <td>True</td>
      <td>59.65461</td>
      <td>5.68847</td>
      <td>7.7236395</td>
      <td>0.3682506</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Remove columns that won&#39;t be used</span>
<span class="n">scaled</span> <span class="o">=</span> <span class="n">scaled</span><span class="p">[[</span><span class="s2">&quot;FW-F&quot;</span><span class="p">,</span> <span class="s2">&quot;FW-SIGF&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># &quot;Unstack&quot; anomalous data from one-column to two-column format</span>
<span class="n">refltable</span> <span class="o">=</span> <span class="n">scaled</span><span class="o">.</span><span class="n">unstack_anomalous</span><span class="p">([</span><span class="s2">&quot;FW-F&quot;</span><span class="p">,</span> <span class="s2">&quot;FW-SIGF&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">refltable</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>FW-F(+)</th>
      <th>FW-SIGF(+)</th>
      <th>N(+)</th>
      <th>FW-F(-)</th>
      <th>FW-SIGF(-)</th>
      <th>N(-)</th>
    </tr>
    <tr>
      <th>H</th>
      <th>K</th>
      <th>L</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th rowspan="5" valign="top">0</th>
      <th>4</th>
      <td>25.895874</td>
      <td>0.42886934</td>
      <td>16</td>
      <td>25.895874</td>
      <td>0.42886934</td>
      <td>16</td>
    </tr>
    <tr>
      <th>8</th>
      <td>57.19014</td>
      <td>0.9409411</td>
      <td>16</td>
      <td>57.190083</td>
      <td>0.94094205</td>
      <td>16</td>
    </tr>
    <tr>
      <th>12</th>
      <td>36.96789</td>
      <td>0.5865023</td>
      <td>16</td>
      <td>36.96788</td>
      <td>0.58650255</td>
      <td>16</td>
    </tr>
    <tr>
      <th>16</th>
      <td>64.35631</td>
      <td>1.5460751</td>
      <td>8</td>
      <td>64.356346</td>
      <td>1.5460743</td>
      <td>8</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.8891001</td>
      <td>0.9376929</td>
      <td>1</td>
      <td>1.8891151</td>
      <td>0.9376951</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Compute differences</span>
<span class="n">dF</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">refltable</span><span class="p">[</span><span class="s2">&quot;FW-F(+)&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">refltable</span><span class="p">[</span><span class="s2">&quot;FW-F(-)&quot;</span><span class="p">])</span>
<span class="n">sigDF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">refltable</span><span class="p">[</span><span class="s2">&quot;FW-SIGF(+)&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">refltable</span><span class="p">[</span><span class="s2">&quot;FW-SIGF(-)&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">refltable</span><span class="p">[</span><span class="s2">&quot;ANOM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">DataSeries</span><span class="p">(</span><span class="n">dF</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;SFAmplitude&quot;</span><span class="p">)</span>
<span class="n">refltable</span><span class="p">[</span><span class="s2">&quot;SigANOM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">DataSeries</span><span class="p">(</span><span class="n">sigDF</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;Stddev&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">refltable</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>FW-F(+)</th>
      <th>FW-SIGF(+)</th>
      <th>N(+)</th>
      <th>FW-F(-)</th>
      <th>FW-SIGF(-)</th>
      <th>N(-)</th>
      <th>ANOM</th>
      <th>SigANOM</th>
    </tr>
    <tr>
      <th>H</th>
      <th>K</th>
      <th>L</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th rowspan="5" valign="top">0</th>
      <th>4</th>
      <td>25.895874</td>
      <td>0.42886934</td>
      <td>16</td>
      <td>25.895874</td>
      <td>0.42886934</td>
      <td>16</td>
      <td>0.0</td>
      <td>0.60651284</td>
    </tr>
    <tr>
      <th>8</th>
      <td>57.19014</td>
      <td>0.9409411</td>
      <td>16</td>
      <td>57.190083</td>
      <td>0.94094205</td>
      <td>16</td>
      <td>5.722046e-05</td>
      <td>1.3306923</td>
    </tr>
    <tr>
      <th>12</th>
      <td>36.96789</td>
      <td>0.5865023</td>
      <td>16</td>
      <td>36.96788</td>
      <td>0.58650255</td>
      <td>16</td>
      <td>1.1444092e-05</td>
      <td>0.82943964</td>
    </tr>
    <tr>
      <th>16</th>
      <td>64.35631</td>
      <td>1.5460751</td>
      <td>8</td>
      <td>64.356346</td>
      <td>1.5460743</td>
      <td>8</td>
      <td>3.8146973e-05</td>
      <td>2.1864798</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.8891001</td>
      <td>0.9376929</td>
      <td>1</td>
      <td>1.8891151</td>
      <td>0.9376951</td>
      <td>1</td>
      <td>1.50203705e-05</td>
      <td>1.3260995</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="Obtaining-Phases-by-Isomorphous-Replacement">
<h2>Obtaining Phases by Isomorphous Replacement<a class="headerlink" href="#Obtaining-Phases-by-Isomorphous-Replacement" title="Permalink to this headline">¶</a></h2>
<p>In order to turn these anomalous differences into a map, we need to get phases. We will do that by isomorphous replacement with a published structure, <a class="reference external" href="https://www.rcsb.org/structure/1vat">1VAT</a>. Phases were generated from the PDB model using <a class="reference external" href="https://www.phenix-online.org/documentation/reference/fmodel.html">phenix.fmodel</a>, and then we will compute the necessary phase shifts in order to go from the conventional structure factor phases to phases associated with the anomalous scattering
contributions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ref</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">read_mtz</span><span class="p">(</span><span class="s2">&quot;data/1VAT_fmodel.mtz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ref</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>FMODEL</th>
      <th>PHIFMODEL</th>
    </tr>
    <tr>
      <th>H</th>
      <th>K</th>
      <th>L</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th rowspan="5" valign="top">0</th>
      <th>4</th>
      <td>954.69275</td>
      <td>180.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1030.4215</td>
      <td>-7.802343e-16</td>
    </tr>
    <tr>
      <th>12</th>
      <td>754.23175</td>
      <td>4.4153507e-15</td>
    </tr>
    <tr>
      <th>16</th>
      <td>533.2781</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>5.3535447</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Find common HKL indices</span>
<span class="n">hkls</span> <span class="o">=</span> <span class="n">refltable</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">refltable</span> <span class="o">=</span> <span class="n">refltable</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hkls</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>As mentioned in <a class="reference internal" href="#Background"><span class="std std-ref">Background</span></a>, we can compute the anomalous phases as follows:</p>
<p><span class="math">\begin{equation*}
\phi_A = \phi_c - \alpha
\end{equation*}</span></p>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is 90˚ when <span class="math notranslate nohighlight">\(\Delta_{\mathrm{ano}}\)</span> is negative and 270˚ when it is positive.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">+</span> <span class="mi">180</span><span class="o">*</span><span class="p">(</span><span class="n">refltable</span><span class="p">[</span><span class="s2">&quot;FW-F(+)&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">refltable</span><span class="p">[</span><span class="s2">&quot;FW-F(-)&quot;</span><span class="p">])</span>
<span class="n">refltable</span><span class="p">[</span><span class="s2">&quot;PHANOM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hkls</span><span class="p">,</span> <span class="s2">&quot;PHIFMODEL&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">alpha</span>
<span class="n">refltable</span><span class="p">[</span><span class="s2">&quot;PHANOM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">canonicalize_phases</span><span class="p">(</span><span class="n">refltable</span><span class="p">[</span><span class="s2">&quot;PHANOM&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Phase&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Viewing-the-Map">
<h2>Viewing the Map<a class="headerlink" href="#Viewing-the-Map" title="Permalink to this headline">¶</a></h2>
<p>Since we have structure factor amplitudes, <code class="docutils literal notranslate"><span class="pre">refltable[&quot;ANOM&quot;]</span></code>, and phases, <code class="docutils literal notranslate"><span class="pre">refltable[&quot;PHANOM&quot;]</span></code>, for the anomalous structure factors, we can now view the anomalous difference map. This can be done by writing out an MTZ file, and loading it into COOT, PyMOL, or any other molecular graphics package.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">refltable</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
FW-F(+)       FriedelSFAmplitude
FW-SIGF(+)       StddevFriedelSF
N(+)                      MTZInt
FW-F(-)       FriedelSFAmplitude
FW-SIGF(-)       StddevFriedelSF
N(-)                      MTZInt
ANOM                 SFAmplitude
SigANOM                   Stddev
PHANOM                     Phase
dtype: object
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">refltable</span><span class="o">.</span><span class="n">write_mtz</span><span class="p">(</span><span class="s2">&quot;data/anomdiff.mtz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Looking at the anomalous difference map on the <code class="docutils literal notranslate"><span class="pre">1VAT</span></code> structure, we can see positive difference density on all of the sulfurs in HEWL (shown below in purple):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>%%html
&lt;center&gt;
    &lt;iframe src=&quot;https://hekstra-lab.github.io/reciprocalspaceship/data/anomdiff/anomdiff.html#zoom=25&quot;, width=600, height=600&gt;&lt;/iframe&gt;
    &lt;br&gt;Anomalous difference map from HEWL crystal overlayed with &lt;b&gt;PDB: 1VAT&lt;/b&gt;. Map is contoured at +5&amp;sigma;.
&lt;/center&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<center>
    <iframe src="https://hekstra-lab.github.io/reciprocalspaceship/data/anomdiff/anomdiff.html#zoom=25", width=600, height=600></iframe>
    <br>Anomalous difference map from HEWL crystal overlayed with <b>PDB: 1VAT</b>. Map is contoured at +5&sigma;.
</center></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="4_timeresolvedPYP.html" class="btn btn-neutral float-right" title="Time-Resolved Difference Map" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="2_mergingstats.html" class="btn btn-neutral float-left" title="HEWL S-SAD Merging Statistics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Jack B. Greisman, Kevin M. Dalton

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>