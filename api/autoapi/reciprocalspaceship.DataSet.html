<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DataSet &mdash; reciprocalspaceship 0.10.2 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/rs-favicon_32x32.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DataSeries" href="reciprocalspaceship.DataSeries.html" />
    <link rel="prev" title="API Reference" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> reciprocalspaceship
            <img src="../../_static/rs.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../userguide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#reflection-data">Reflection Data</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">DataSet</a></li>
<li class="toctree-l3"><a class="reference internal" href="reciprocalspaceship.DataSeries.html">DataSeries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#input-output">Input/Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#algorithms">Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#summary-statistics">Summary Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#helpful-functions">Helpful Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#commandline-tools">Commandline Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developers/index.html">For Developers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">reciprocalspaceship</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">API Reference</a> &raquo;</li>
      <li>DataSet</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/api/autoapi/reciprocalspaceship.DataSet.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="dataset">
<h1>DataSet<a class="headerlink" href="#dataset" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reciprocalspaceship.</span></span><span class="sig-name descname"><span class="pre">DataSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacegroup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L32-L1457"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.core.frame.DataFrame</span></code></p>
<p>Representation of a crystallographic dataset.</p>
<p>A DataSet object provides a tabular representation of reflection data.
Reflections are conventionally indexed by Miller indices (rows), but
can also be indexed by additional metadata. Per-reflection data can be
stored as columns. For additional information about inherited methods
and attributes, please see the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">Pandas.DataFrame documentation</a>.</p>
<p class="rubric">Attributes</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.acentrics" title="reciprocalspaceship.DataSet.acentrics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">acentrics</span></code></a></p></td>
<td><p>Access acentric reflections in DataSet</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.cell" title="reciprocalspaceship.DataSet.cell"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cell</span></code></a></p></td>
<td><p>Unit cell parameters (a, b, c, alpha, beta, gamma)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.centrics" title="reciprocalspaceship.DataSet.centrics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">centrics</span></code></a></p></td>
<td><p>Access centric reflections in DataSet</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.merged" title="reciprocalspaceship.DataSet.merged"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merged</span></code></a></p></td>
<td><p>Whether DataSet contains merged reflection data (boolean)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.spacegroup" title="reciprocalspaceship.DataSet.spacegroup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spacegroup</span></code></a></p></td>
<td><p>Crystallographic space group</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code>([data, index, columns, dtype, ...])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.apply_symop" title="reciprocalspaceship.DataSet.apply_symop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_symop</span></code></a>(symop[, inplace])</p></td>
<td><p>Apply symmetry operation to all reflections in DataSet object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.assign_resolution_bins" title="reciprocalspaceship.DataSet.assign_resolution_bins"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assign_resolution_bins</span></code></a>([bins, inplace, ...])</p></td>
<td><p>Assign reflections in DataSet to resolution bins.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.canonicalize_phases" title="reciprocalspaceship.DataSet.canonicalize_phases"><code class="xref py py-obj docutils literal notranslate"><span class="pre">canonicalize_phases</span></code></a>([inplace])</p></td>
<td><p>Canonicalize columns with phase data to fall in the interval between -180 and 180 degrees.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.compute_dHKL" title="reciprocalspaceship.DataSet.compute_dHKL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_dHKL</span></code></a>([inplace])</p></td>
<td><p>Compute the real space lattice plane spacing, d, associated with the HKL indices in the object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.compute_multiplicity" title="reciprocalspaceship.DataSet.compute_multiplicity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_multiplicity</span></code></a>([inplace, ...])</p></td>
<td><p>Compute the multiplicity of reflections in DataSet.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.expand_anomalous" title="reciprocalspaceship.DataSet.expand_anomalous"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expand_anomalous</span></code></a>()</p></td>
<td><p>Expands data by applying Friedel operator (-x, -y, -z).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.expand_to_p1" title="reciprocalspaceship.DataSet.expand_to_p1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expand_to_p1</span></code></a>()</p></td>
<td><p>Generates all symmetrically equivalent reflections.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.from_gemmi" title="reciprocalspaceship.DataSet.from_gemmi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_gemmi</span></code></a>(gemmiMtz)</p></td>
<td><p>Creates DataSet object from gemmi.Mtz object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.from_structurefactor" title="reciprocalspaceship.DataSet.from_structurefactor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_structurefactor</span></code></a>(sf_key)</p></td>
<td><p>Convert complex structure factors to structure factor amplitudes and phases</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.get_complex_keys" title="reciprocalspaceship.DataSet.get_complex_keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_keys</span></code></a>()</p></td>
<td><p>Return columns labels for data with complex dtype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.get_hkls" title="reciprocalspaceship.DataSet.get_hkls"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_hkls</span></code></a>()</p></td>
<td><p>Get the Miller indices in the DataSet as a ndarray.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.get_m_isym_keys" title="reciprocalspaceship.DataSet.get_m_isym_keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_m_isym_keys</span></code></a>()</p></td>
<td><p>Return column labels for data with M/ISYM dtype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.get_phase_keys" title="reciprocalspaceship.DataSet.get_phase_keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_phase_keys</span></code></a>()</p></td>
<td><p>Return column labels for data with Phase dtype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.get_reciprocal_grid_size" title="reciprocalspaceship.DataSet.get_reciprocal_grid_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_reciprocal_grid_size</span></code></a>([dmin, sample_rate])</p></td>
<td><p>Determine an appropriate 3D grid size for reflection data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.hkl_to_asu" title="reciprocalspaceship.DataSet.hkl_to_asu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hkl_to_asu</span></code></a>([inplace, anomalous])</p></td>
<td><p>Map HKL indices to the reciprocal space asymmetric unit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.hkl_to_observed" title="reciprocalspaceship.DataSet.hkl_to_observed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hkl_to_observed</span></code></a>([m_isym, inplace])</p></td>
<td><p>Map HKL indices to their observed index using an <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code> column.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.infer_mtz_dtypes" title="reciprocalspaceship.DataSet.infer_mtz_dtypes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">infer_mtz_dtypes</span></code></a>([inplace, index])</p></td>
<td><p>Infers MTZ dtypes from column names and underlying data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.is_isomorphous" title="reciprocalspaceship.DataSet.is_isomorphous"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_isomorphous</span></code></a>(other[, cell_threshold])</p></td>
<td><p>Determine whether DataSet is isomorphous to another DataSet.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.join" title="reciprocalspaceship.DataSet.join"><code class="xref py py-obj docutils literal notranslate"><span class="pre">join</span></code></a>(*args[, check_isomorphous])</p></td>
<td><p>Join DataSets or named DataSeries using a database-style join on columns or indices.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.label_absences" title="reciprocalspaceship.DataSet.label_absences"><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_absences</span></code></a>([inplace])</p></td>
<td><p>Label systematically absent reflections in DataSet.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.label_centrics" title="reciprocalspaceship.DataSet.label_centrics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_centrics</span></code></a>([inplace])</p></td>
<td><p>Label centric reflections in DataSet.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.merge" title="reciprocalspaceship.DataSet.merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge</span></code></a>(*args[, check_isomorphous])</p></td>
<td><p>Merge DataSet or named DataSeries using a database-style join on columns or indices.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.remove_absences" title="reciprocalspaceship.DataSet.remove_absences"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_absences</span></code></a>([inplace])</p></td>
<td><p>Remove systematically absent reflections in DataSet.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.reset_index" title="reciprocalspaceship.DataSet.reset_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset_index</span></code></a>([level, drop, inplace, ...])</p></td>
<td><p>Reset the index or a specific level of a MultiIndex.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.select_mtzdtype" title="reciprocalspaceship.DataSet.select_mtzdtype"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_mtzdtype</span></code></a>(dtype)</p></td>
<td><p>Return subset of DataSet’s columns that are of the given dtype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.set_index" title="reciprocalspaceship.DataSet.set_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_index</span></code></a>(keys[, drop, append, inplace, ...])</p></td>
<td><p>Set the DataSet index using existing columns.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.stack_anomalous" title="reciprocalspaceship.DataSet.stack_anomalous"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stack_anomalous</span></code></a>([plus_labels, minus_labels, ...])</p></td>
<td><p>Convert data from two-column anomalous format to one-column format.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.to_gemmi" title="reciprocalspaceship.DataSet.to_gemmi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_gemmi</span></code></a>([skip_problem_mtztypes, ...])</p></td>
<td><p>Creates gemmi.Mtz object from DataSet object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.to_pickle" title="reciprocalspaceship.DataSet.to_pickle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_pickle</span></code></a>(path, *args, **kwargs)</p></td>
<td><p>Pickle object to file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.to_reciprocal_grid" title="reciprocalspaceship.DataSet.to_reciprocal_grid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_reciprocal_grid</span></code></a>(key[, sample_rate, dmin, ...])</p></td>
<td><p>Set up reciprocal grid with values from column, <code class="docutils literal notranslate"><span class="pre">key</span></code>, indexed by Miller indices.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.to_reciprocalgrid" title="reciprocalspaceship.DataSet.to_reciprocalgrid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_reciprocalgrid</span></code></a>(key[, sample_rate, dmin, ...])</p></td>
<td><p>Deprecated: Set up reciprocal grid with values from column, <code class="docutils literal notranslate"><span class="pre">key</span></code>, indexed by Miller indices.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.to_structurefactor" title="reciprocalspaceship.DataSet.to_structurefactor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_structurefactor</span></code></a>(sf_key, phase_key)</p></td>
<td><p>Convert structure factor amplitudes and phases to complex structure factors</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.unstack_anomalous" title="reciprocalspaceship.DataSet.unstack_anomalous"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unstack_anomalous</span></code></a>([columns, suffixes])</p></td>
<td><p>Convert data from one-column format to two-column anomalous format.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#reciprocalspaceship.DataSet.write_mtz" title="reciprocalspaceship.DataSet.write_mtz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_mtz</span></code></a>(mtzfile[, skip_problem_mtztypes, ...])</p></td>
<td><p>Write DataSet to MTZ file.</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.acentrics">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">acentrics</span></span><a class="headerlink" href="#reciprocalspaceship.DataSet.acentrics" title="Permalink to this definition"></a></dt>
<dd><p>Access acentric reflections in DataSet</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.apply_symop">
<span class="sig-name descname"><span class="pre">apply_symop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L608-L653"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.apply_symop" title="Permalink to this definition"></a></dt>
<dd><p>Apply symmetry operation to all reflections in DataSet object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symop</strong> (<em>str, gemmi.Op</em>) – Gemmi symmetry operation or string representing symmetry op</p></li>
<li><p><strong>inplace</strong> (<em>bool</em>) – Whether to return a new DataFrame or make the change in place</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.assign_resolution_bins">
<span class="sig-name descname"><span class="pre">assign_resolution_bins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L793-L820"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.assign_resolution_bins" title="Permalink to this definition"></a></dt>
<dd><p>Assign reflections in DataSet to resolution bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bins</strong> (<em>int</em>) – Number of bins</p></li>
<li><p><strong>inplace</strong> (<em>bool</em>) – Whether to add the column in place or return a copy</p></li>
<li><p><strong>return_labels</strong> (<em>bool</em>) – Whether to return a list of labels corresponding to the edges
of each resolution bin</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>(DataSet, list) or DataSet</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.canonicalize_phases">
<span class="sig-name descname"><span class="pre">canonicalize_phases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L1270-L1289"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.canonicalize_phases" title="Permalink to this definition"></a></dt>
<dd><p>Canonicalize columns with phase data to fall in the interval between
-180 and 180 degrees. This method will modify the values within any
column composed of data with the PhaseDtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) – Whether to modify the DataSet in place or return a copy</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.cell">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cell</span></span><a class="headerlink" href="#reciprocalspaceship.DataSet.cell" title="Permalink to this definition"></a></dt>
<dd><p>Unit cell parameters (a, b, c, alpha, beta, gamma)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.centrics">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">centrics</span></span><a class="headerlink" href="#reciprocalspaceship.DataSet.centrics" title="Permalink to this definition"></a></dt>
<dd><p>Access centric reflections in DataSet</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.compute_dHKL">
<span class="sig-name descname"><span class="pre">compute_dHKL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L758-L771"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.compute_dHKL" title="Permalink to this definition"></a></dt>
<dd><p>Compute the real space lattice plane spacing, d, associated with
the HKL indices in the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) – Whether to add the column in place or return a copy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.compute_multiplicity">
<span class="sig-name descname"><span class="pre">compute_multiplicity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_centering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L773-L791"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.compute_multiplicity" title="Permalink to this definition"></a></dt>
<dd><p>Compute the multiplicity of reflections in DataSet. A new column of
floats, “EPSILON”, is added to the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inplace</strong> (<em>bool</em>) – Whether to add the column in place or to return a copy</p></li>
<li><p><strong>include_centering</strong> (<em>bool</em>) – Whether to include centering operations in the multiplicity calculation.
The default is to include them.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.expand_anomalous">
<span class="sig-name descname"><span class="pre">expand_anomalous</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L1257-L1268"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.expand_anomalous" title="Permalink to this definition"></a></dt>
<dd><p>Expands data by applying Friedel operator (-x, -y, -z). The
necessary phase shifts are made for columns of complex
dtypes or PhaseDtypes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>DataSet</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.expand_to_p1">
<span class="sig-name descname"><span class="pre">expand_to_p1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L1223-L1255"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.expand_to_p1" title="Permalink to this definition"></a></dt>
<dd><p>Generates all symmetrically equivalent reflections. The spacegroup
symmetry is set to P1.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>DataSet</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.from_gemmi">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_gemmi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gemmiMtz</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L295-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.from_gemmi" title="Permalink to this definition"></a></dt>
<dd><p>Creates DataSet object from gemmi.Mtz object.</p>
<p>If the gemmi.Mtz object contains an M/ISYM column and contains duplicated
Miller indices, an unmerged DataSet will be constructed. The Miller indices
will be mapped to their observed values, and a partiality flag will be
extracted and stored as a boolean column with the label, <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code>.
Otherwise, a merged DataSet will be constructed.</p>
<p>If columns are found with the <code class="docutils literal notranslate"><span class="pre">MTZInt</span></code> dtype and are labeled <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code>
or <code class="docutils literal notranslate"><span class="pre">CENTRIC</span></code>, these will be interpreted as boolean flags used to
label partial or centric reflections, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gemmiMtz</strong> (<em>gemmi.Mtz</em>)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.from_structurefactor">
<span class="sig-name descname"><span class="pre">from_structurefactor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sf_key</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L401-L421"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.from_structurefactor" title="Permalink to this definition"></a></dt>
<dd><p>Convert complex structure factors to structure factor amplitudes
and phases</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sf_key</strong> (<em>str</em>) – Column label for complex structure factors</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>(sf, phase)</strong> (<em>tuple of DataSeris</em>) – Tuple of DataSeries for the structure factor amplitudes and
phases corresponding to the complex structure factors</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.to_structurefactor" title="reciprocalspaceship.DataSet.to_structurefactor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataSet.to_structurefactor</span></code></a></dt><dd><p>Convert amplitude and phase to complex structure factor</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.get_complex_keys">
<span class="sig-name descname"><span class="pre">get_complex_keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L584-L594"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.get_complex_keys" title="Permalink to this definition"></a></dt>
<dd><p>Return columns labels for data with complex dtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>list of strings</em>) – list of column labels with complex dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.get_hkls">
<span class="sig-name descname"><span class="pre">get_hkls</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L655-L665"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.get_hkls" title="Permalink to this definition"></a></dt>
<dd><p>Get the Miller indices in the DataSet as a ndarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>hkl</strong> (<em>ndarray, shape=(n_reflections, 3)</em>) – Miller indices in DataSet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.get_m_isym_keys">
<span class="sig-name descname"><span class="pre">get_m_isym_keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L596-L606"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.get_m_isym_keys" title="Permalink to this definition"></a></dt>
<dd><p>Return column labels for data with M/ISYM dtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>list of strings</em>) – list of column labels with <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code> dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.get_phase_keys">
<span class="sig-name descname"><span class="pre">get_phase_keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L572-L582"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.get_phase_keys" title="Permalink to this definition"></a></dt>
<dd><p>Return column labels for data with Phase dtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>list of strings</em>) – list of column labels with <code class="docutils literal notranslate"><span class="pre">Phase</span></code> dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.get_reciprocal_grid_size">
<span class="sig-name descname"><span class="pre">get_reciprocal_grid_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L1291-L1319"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.get_reciprocal_grid_size" title="Permalink to this definition"></a></dt>
<dd><p>Determine an appropriate 3D grid size for reflection data.</p>
<p>Returns the smallest grid size that yields a real-space grid spacing
of at most <cite>dmin</cite>/<cite>sample_rate</cite> (in Å). The returned grid size will
be ‘FFT-friendly’ (2, 3, or 5 are the largest prime factors), and will
obey any symmetry constraints of the spacegroup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dmin</strong> (<em>float</em>) – Highest-resolution reflection to consider for grid size</p></li>
<li><p><strong>sample_rate</strong> (<em>float</em>) – Sets the minimal grid spacing relative to dmin. For example,
<cite>sample_rate=3</cite> corresponds to a real-space sampling of dmin/3.
Value must be &gt;= 1.0 (default: 3.0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>list(int, int, int)</em> – Grid size with desired spacing (list of 3 integers)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.hkl_to_asu">
<span class="sig-name descname"><span class="pre">hkl_to_asu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomalous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L1077-L1147"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.hkl_to_asu" title="Permalink to this definition"></a></dt>
<dd><p>Map HKL indices to the reciprocal space asymmetric unit. If phases
are included in the DataSet, they will be changed according to the
phase shift associated with the necessary symmetry operation.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">False</span></code>, and a partiality flag labeled <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code>
is included in the DataSet, the partiality flag will be used to
construct a proper M/ISYM column. Both merged and unmerged DataSets
will have an M/ISYM column added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inplace</strong> (<em>bool</em>) – Whether to modify the DataSet in place or return a copy</p></li>
<li><p><strong>anomalous</strong> (<em>bool</em>) – If True, acentric reflections will be mapped to the +/- ASU.
If False, all reflections are mapped to the Friedel-plus ASU.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.hkl_to_observed" title="reciprocalspaceship.DataSet.hkl_to_observed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataSet.hkl_to_observed</span></code></a></dt><dd><p>Opposite of DataSet.hkl_to_asu()</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.hkl_to_observed">
<span class="sig-name descname"><span class="pre">hkl_to_observed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m_isym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L1149-L1221"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.hkl_to_observed" title="Permalink to this definition"></a></dt>
<dd><p>Map HKL indices to their observed index using an <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code> column.
This method applies the symmetry operation specified by the <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code>
column to each Miller index in the DataSet. If phases are included
in the DataSet, they will be changed by the phase shift associated
with the symmetry operation.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">False</span></code>, the <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code> column is used to
construct a partiality flag labeled <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code>. This is added to
the DataSet, and the M/ISYM column is dropped. If
<code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">True</span></code>, the <code class="docutils literal notranslate"><span class="pre">M/ISYM</span></code> column is dropped, but
a partiality flag is not added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m_isym</strong> (<em>str</em>) – Column label for M/ISYM values in DataSet. If m_isym is None
and a single M/ISYM column is present, it will automatically
be used.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em>) – Whether to modify the DataSet in place or return a copy</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.hkl_to_asu" title="reciprocalspaceship.DataSet.hkl_to_asu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataSet.hkl_to_asu</span></code></a></dt><dd><p>Opposite of DataSet.hkl_to_observed()</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.infer_mtz_dtypes">
<span class="sig-name descname"><span class="pre">infer_mtz_dtypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L718-L756"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.infer_mtz_dtypes" title="Permalink to this definition"></a></dt>
<dd><p>Infers MTZ dtypes from column names and underlying data. This
method iterates over each column in the DataSet and tries to infer
its proper MTZ dtype based on common MTZ naming conventions.</p>
<p>If a given column is already a MTZDtype, its type will be unchanged.
If index is True, the MTZ dtypes will be inferred for named columns
in the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inplace</strong> (<em>bool</em>) – Whether to modify the dtypes in place or to return a copy</p></li>
<li><p><strong>index</strong> (<em>bool</em>) – Infer MTZ dtypes for named column(s) in the DataSet index</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="reciprocalspaceship.DataSeries.html#reciprocalspaceship.DataSeries.infer_mtz_dtype" title="reciprocalspaceship.DataSeries.infer_mtz_dtype"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataSeries.infer_mtz_dtype</span></code></a></dt><dd><p>Infer MTZ dtype for DataSeries</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.is_isomorphous">
<span class="sig-name descname"><span class="pre">is_isomorphous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L1035-L1075"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.is_isomorphous" title="Permalink to this definition"></a></dt>
<dd><p>Determine whether DataSet is isomorphous to another DataSet. This
method confirms isomorphism by ensuring the spacegroups are equivalent,
and that the cell parameters are within a specified percentage
(see <cite>cell_threshold</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>rs.DataSet</em>) – DataSet to which it will be compared</p></li>
<li><p><strong>cell_threshold</strong> (<em>float</em>) – Acceptable percent difference between unit cell parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>bool</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_isomorphous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L453-L487"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.join" title="Permalink to this definition"></a></dt>
<dd><p>Join DataSets or named DataSeries using a database-style join on
columns or indices. This method can be used to join lists <code class="docutils literal notranslate"><span class="pre">rs</span></code> objects
to a given DataSet.</p>
<p>For additional documentation on accepted arguments, see the
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.join.html">Pandas DataFrame.join() API</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>check_isomorphous</strong> (<em>bool</em>) – If True, the spacegroup and cell attributes of DataSets in <cite>other</cite>
will be compared to those of the calling DataSet to ensure
they are isomorphous.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>rs.DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.merge" title="reciprocalspaceship.DataSet.merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataSet.merge</span></code></a></dt><dd><p>Similar method with added flexibility for distinct column labels</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.label_absences">
<span class="sig-name descname"><span class="pre">label_absences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L683-L697"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.label_absences" title="Permalink to this definition"></a></dt>
<dd><p>Label systematically absent reflections in DataSet. A new column
of booleans, “ABSENT”, is added to the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) – Whether to add the column in place or to return a copy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.label_centrics">
<span class="sig-name descname"><span class="pre">label_centrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L667-L681"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.label_centrics" title="Permalink to this definition"></a></dt>
<dd><p>Label centric reflections in DataSet. A new column of
booleans, “CENTRIC”, is added to the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) – Whether to add the column in place or to return a copy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_isomorphous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L423-L451"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.merge" title="Permalink to this definition"></a></dt>
<dd><p>Merge DataSet or named DataSeries using a database-style join on
columns or indices.</p>
<p>For additional documentation on accepted arguments, see the
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html">Pandas DataFrame.merge() API</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>check_isomorphous</strong> (<em>bool</em>) – If True, the spacegroup and cell attributes of DataSets in <cite>other</cite>
will be compared to those of the calling DataSet to ensure
they are isomorphous.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>rs.DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.join" title="reciprocalspaceship.DataSet.join"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataSet.join</span></code></a></dt><dd><p>Similar method with support for lists of <code class="docutils literal notranslate"><span class="pre">rs</span></code> objects</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.merged">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">merged</span></span><a class="headerlink" href="#reciprocalspaceship.DataSet.merged" title="Permalink to this definition"></a></dt>
<dd><p>Whether DataSet contains merged reflection data (boolean)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.remove_absences">
<span class="sig-name descname"><span class="pre">remove_absences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L699-L716"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.remove_absences" title="Permalink to this definition"></a></dt>
<dd><p>Remove systematically absent reflections in DataSet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inplace</strong> (<em>bool</em>) – Whether to add the column in place or to return a copy</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.reset_index">
<span class="sig-name descname"><span class="pre">reset_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L220-L293"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.reset_index" title="Permalink to this definition"></a></dt>
<dd><p>Reset the index or a specific level of a MultiIndex.</p>
<p>Reset the index to use a numbered RangeIndex. Using the <cite>level</cite>
argument, it is possible to reset one or more levels of a MultiIndex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<em>int, str, tuple, list</em>) – Only remove given levels from the index. Defaults to all levels</p></li>
<li><p><strong>drop</strong> (<em>bool</em>) – Do not try to insert index into dataframe columns.</p></li>
<li><p><strong>inplace ; bool</strong> – Modify the DataSet in place (do not create a new object).</p></li>
<li><p><strong>col_level</strong> (<em>int or str</em>) – If the columns have multiple levels, determines which level
the labels are inserted into. By default it is inserted into
the first level.</p></li>
<li><p><strong>col_fill</strong> (<em>object</em>) – If the columns have multiple levels, determines how the other
levels are named. If None then the index name is repeated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet or None</em> – DataSet with the new index or None if <cite>inplace=True</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.set_index" title="reciprocalspaceship.DataSet.set_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataSet.set_index</span></code></a></dt><dd><p>Set index</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.select_mtzdtype">
<span class="sig-name descname"><span class="pre">select_mtzdtype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L532-L570"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.select_mtzdtype" title="Permalink to this definition"></a></dt>
<dd><p>Return subset of DataSet’s columns that are of the given dtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dtype</strong> (<em>str or instance of MTZDtype</em>) – Single-letter MTZ code, name, or MTZDtype instance to return</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em> – Subset of the DataSet with columns matching the requested dtype. If
no columns of the requested dtype are found, an empty DataSet is
returned.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If <cite>dtype</cite> is not a string nor a MTZDtype instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.set_index">
<span class="sig-name descname"><span class="pre">set_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verify_integrity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L160-L218"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.set_index" title="Permalink to this definition"></a></dt>
<dd><p>Set the DataSet index using existing columns.</p>
<p>Set the DataSet index (row labels) using one or more existing
columns or arrays (of the correct length). The index can replace
the existing index or expand on it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<em>label or array-like or list of labels/arrays</em>) – This parameter can be either a single column key, a single
array of the same length as the calling DataSet, or a list
containing an arbitrary combination of column keys and arrays.</p></li>
<li><p><strong>drop</strong> (<em>bool</em>) – Whether to delete columns to be used as the new index.</p></li>
<li><p><strong>append</strong> (<em>bool</em>) – Whether to append columns to existing index.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em>) – Modify the DataFrame in place (do not create a new object).</p></li>
<li><p><strong>verify_integrity</strong> (<em>bool</em>) – Check the new index for duplicates. Otherwise defer the check
until necessary. Setting to False will improve the performance
of this method</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet or None</em> – DataSet with the new index or None if <cite>inplace=True</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.reset_index" title="reciprocalspaceship.DataSet.reset_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataSet.reset_index</span></code></a></dt><dd><p>Reset index</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.spacegroup">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spacegroup</span></span><a class="headerlink" href="#reciprocalspaceship.DataSet.spacegroup" title="Permalink to this definition"></a></dt>
<dd><p>Crystallographic space group</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.stack_anomalous">
<span class="sig-name descname"><span class="pre">stack_anomalous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plus_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minus_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffixes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('(+)',</span> <span class="pre">'(-)')</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L822-L951"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.stack_anomalous" title="Permalink to this definition"></a></dt>
<dd><p>Convert data from two-column anomalous format to one-column
format. Intensities, structure factor amplitudes, or other data
are converted from separate columns corresponding to a single
Miller index to the same data column at different rows indexed
by the Friedel-plus or Friedel-minus Miller index.</p>
<p>This method will return a DataSet with, at most, twice as many rows as the
original –  one row for each Friedel pair. In most cases, the resulting
DataSet will be smaller, because centric reflections will not be stacked.
For a merged DataSet, this has the effect of mapping reflections
from the positive reciprocal space ASU to the positive and negative
reciprocal space ASU, for Friedel-plus and Friedel-minus reflections,
respectively.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>A ValueError is raised if invoked with an unmerged DataSet</p></li>
<li><p>It is assumed that Friedel-plus column labels are suffixed with (+),
and that Friedel-minus column labels are suffixed with (-)</p></li>
<li><p>A ValueError is raised if stripping suffixes will lead to a duplicate
column name</p></li>
<li><p>Corresponding column labels are expected to be given in the same order</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plus_labels</strong> (<em>str or list-like</em>) – Column label or list of column labels of data associated with
Friedel-plus reflections</p></li>
<li><p><strong>minus_labels</strong> (<em>str or list-like</em>) – Column label or list of column labels of data associated with
Friedel-minus reflections</p></li>
<li><p><strong>suffixes</strong> (<em>list of strings</em>) – Suffixes to identify column labels associated with Friedel-plus
and Friedel-minus reflections. Only consulted if plus_labels and
minus_labels are None. Defaults to (“(+)”, “(-)”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.unstack_anomalous" title="reciprocalspaceship.DataSet.unstack_anomalous"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataSet.unstack_anomalous</span></code></a></dt><dd><p>Opposite of stack_anomalous</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.to_gemmi">
<span class="sig-name descname"><span class="pre">to_gemmi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_problem_mtztypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reciprocalspaceship'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reciprocalspaceship'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reciprocalspaceship'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L320-L357"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.to_gemmi" title="Permalink to this definition"></a></dt>
<dd><p>Creates gemmi.Mtz object from DataSet object.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dataset.merged</span> <span class="pre">==</span> <span class="pre">False</span></code>, the reflections will be mapped to the
reciprocal space ASU, and a M/ISYM column will be constructed.</p>
<p>If boolean flags with the label <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code> or <code class="docutils literal notranslate"><span class="pre">CENTRIC</span></code> are found
in the DataSet, these will be cast to the <code class="docutils literal notranslate"><span class="pre">MTZInt</span></code> dtype, and included
in the gemmi.Mtz object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skip_problem_mtztypes</strong> (<em>bool</em>) – Whether to skip columns in DataSet that do not have specified
MTZ datatypes</p></li>
<li><p><strong>project_name</strong> (<em>str</em>) – Project name to assign to MTZ file</p></li>
<li><p><strong>crystal_name</strong> (<em>str</em>) – Crystal name to assign to MTZ file</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) – Dataset name to assign to MTZ file</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>gemmi.Mtz</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.to_pickle">
<span class="sig-name descname"><span class="pre">to_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L359-L375"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.to_pickle" title="Permalink to this definition"></a></dt>
<dd><p>Pickle object to file.</p>
<p>This can be useful for saving non-MTZ compatible data files for future use. For additional documentation on accepted arguments, see the
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_pickle.html">Pandas DataFrame.to_pickle() API</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – File path where the pickled object will be stored.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="reciprocalspaceship.read_pickle.html#reciprocalspaceship.read_pickle" title="reciprocalspaceship.read_pickle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_pickle</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.to_reciprocal_grid">
<span class="sig-name descname"><span class="pre">to_reciprocal_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L1321-L1383"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.to_reciprocal_grid" title="Permalink to this definition"></a></dt>
<dd><p>Set up reciprocal grid with values from column, <code class="docutils literal notranslate"><span class="pre">key</span></code>, indexed by
Miller indices.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The data being arranged on a reciprocal grid must be compatible
with a numpy datatype.</p></li>
<li><p>Any missing Miller indices are initialized to zero.</p></li>
<li><p>If explicitly provided, <cite>grid_size</cite> supersedes <cite>dmin</cite> and <cite>sample_rate</cite>
for grid size determination.</p></li>
<li><p>The grid size determined using <cite>sample_rate</cite> and <cite>dmin</cite> will depend
on the cell parameters of the dataset. If the grid size must be
consistent across different isomorphous cell parameters, <cite>grid_size</cite>
can be explicitly provided.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – Column label for value to arrange on reciprocal grid</p></li>
<li><p><strong>sample_rate</strong> (<em>float</em>) – Sets the minimal grid spacing relative to dmin. For example,
<cite>sample_rate=3</cite> corresponds to a real-space sampling of dmin/3.
(default: 3.0)</p></li>
<li><p><strong>dmin</strong> (<em>float</em>) – Highest-resolution reflection to consider for grid size. If None,
<cite>dmin</cite> will be set to the highest resolution reflection in the
dataset. The reflections used to populate the grid will also
be truncated to <cite>dHKL &gt;= dmin</cite> (default: None)</p></li>
<li><p><strong>grid_size</strong> (<em>array-like (len==3)</em>) – If given, provides the explicit dimensions for 3D reciprocal
grid. If None, grid size will be set based on <cite>sample_rate</cite> and
<cite>dmin</cite>. If provided, this grid size will be used regardless of
the values provided as <cite>sample_rate</cite> and <cite>dmin</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>numpy.ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.to_reciprocalgrid">
<span class="sig-name descname"><span class="pre">to_reciprocalgrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L1385-L1457"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.to_reciprocalgrid" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated: Set up reciprocal grid with values from column, <code class="docutils literal notranslate"><span class="pre">key</span></code>, indexed by
Miller indices.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is deprecated. Use <code class="docutils literal notranslate"><span class="pre">to_reciprocal_grid()</span></code> instead.</p>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The data being arranged on a reciprocal grid must be compatible
with a numpy datatype.</p></li>
<li><p>Any missing Miller indices are initialized to zero.</p></li>
<li><p>If explicitly provided, <cite>gridsize</cite> supersedes <cite>dmin</cite> and <cite>sample_rate</cite>
for grid size determination.</p></li>
<li><p>The grid size determined using <cite>sample_rate</cite> and <cite>dmin</cite> will depend
on the cell parameters of the dataset. If the grid size must be
consistent across different isomorphous cell parameters, <cite>gridsize</cite>
can be explicitly provided.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – Column label for value to arrange on reciprocal grid</p></li>
<li><p><strong>sample_rate</strong> (<em>float</em>) – Sets the minimal grid spacing relative to dmin. For example,
<cite>sample_rate=3</cite> corresponds to a real-space sampling of dmin/3.
(default: 3.0)</p></li>
<li><p><strong>dmin</strong> (<em>float</em>) – Highest-resolution reflection to consider for grid size. If None,
<cite>dmin</cite> will be set to the highest resolution reflection in the
dataset. The reflections used to populate the grid will also
be truncated to <cite>dHKL &gt;= dmin</cite> (default: None)</p></li>
<li><p><strong>gridsize</strong> (<em>array-like (len==3)</em>) – If given, provides the explicit dimensions for 3D reciprocal
grid. If None, grid size will be set based on <cite>sample_rate</cite> and
<cite>dmin</cite>. If provided, this grid size will be used regardless of
the values provided as <cite>sample_rate</cite> and <cite>dmin</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>numpy.ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.to_structurefactor">
<span class="sig-name descname"><span class="pre">to_structurefactor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sf_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_key</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L377-L399"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.to_structurefactor" title="Permalink to this definition"></a></dt>
<dd><p>Convert structure factor amplitudes and phases to complex structure
factors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sf_key</strong> (<em>str</em>) – Column label for structure factor amplitudes</p></li>
<li><p><strong>phase_key</strong> (<em>str</em>) – Column label for phases</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>rs.DataSeries</em> – Complex structure factors</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.from_structurefactor" title="reciprocalspaceship.DataSet.from_structurefactor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataSet.from_structurefactor</span></code></a></dt><dd><p>Convert complex structure factor to amplitude and phase</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.unstack_anomalous">
<span class="sig-name descname"><span class="pre">unstack_anomalous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffixes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('(+)',</span> <span class="pre">'(-)')</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L953-L1033"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.unstack_anomalous" title="Permalink to this definition"></a></dt>
<dd><p>Convert data from one-column format to two-column anomalous
format. Provided column labels are converted from separate rows
indexed by their Friedel-plus or Friedel-minus Miller index to
different columns indexed at the Friedel-plus HKL.</p>
<p>This method will return a smaller DataSet than the original –
Friedel pairs will both be indexed at the Friedel-plus index. This
has the effect of mapping reflections to the positive reciprocal
space ASU, including data for both Friedel pairs at the Friedel-plus
Miller index.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>A ValueError is raised if invoked with an unmerged DataSet</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> (<em>str or list-like</em>) – Column label or list of column labels of data that should be
associated with Friedel pairs. If None, all columns are
converted to the two-column anomalous format.</p></li>
<li><p><strong>suffixes</strong> (<em>tuple or list  of str</em>) – Suffixes to append to Friedel-plus and Friedel-minus data
columns</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>DataSet</em></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#reciprocalspaceship.DataSet.stack_anomalous" title="reciprocalspaceship.DataSet.stack_anomalous"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataSet.stack_anomalous</span></code></a></dt><dd><p>Opposite of unstack_anomalous</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reciprocalspaceship.DataSet.write_mtz">
<span class="sig-name descname"><span class="pre">write_mtz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mtzfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_problem_mtztypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reciprocalspaceship'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reciprocalspaceship'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reciprocalspaceship'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/Hekstra-Lab/reciprocalspaceship/blob/main/reciprocalspaceship/dataset.py#L489-L530"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reciprocalspaceship.DataSet.write_mtz" title="Permalink to this definition"></a></dt>
<dd><p>Write DataSet to MTZ file.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">DataSet.merged</span> <span class="pre">==</span> <span class="pre">False</span></code>, the reflections will be mapped to the
reciprocal space ASU, and a M/ISYM column will be constructed.</p>
<p>If boolean flags with the label <code class="docutils literal notranslate"><span class="pre">PARTIAL</span></code> or <code class="docutils literal notranslate"><span class="pre">CENTRIC</span></code> are found
in the DataSet, these will be cast to the <code class="docutils literal notranslate"><span class="pre">MTZInt</span></code> dtype, and included
in the output MTZ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mtzfile</strong> (<em>str or file</em>) – name of an mtz file or a file object</p></li>
<li><p><strong>skip_problem_mtztypes</strong> (<em>bool</em>) – Whether to skip columns in DataSet that do not have specified
MTZ datatypes</p></li>
<li><p><strong>project_name</strong> (<em>str</em>) – Project name to assign to MTZ file</p></li>
<li><p><strong>crystal_name</strong> (<em>str</em>) – Crystal name to assign to MTZ file</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) – Dataset name to assign to MTZ file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="reciprocalspaceship.DataSeries.html" class="btn btn-neutral float-right" title="DataSeries" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Jack B. Greisman, Kevin M. Dalton.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>